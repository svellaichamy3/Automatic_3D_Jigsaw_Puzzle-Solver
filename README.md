# Automatic 3D Jigsaw Puzzle solver with applications in archaeology for reassembling fragments

## Project aim and scope
A large number of fragments are discovered during archaeological excavations and heritage site restoration tasks. Finding their relative positions is a very laborious yet crucial step. Manual methods are time-consuming, demands the construction of special supporting structures, labor intensive for heavy fragments and can potentially damage the fragile pieces during the process. With advancements in technological developments to digitalize objects, computers can aid to a great extent in automating the process thereby reducing time, manpower and potential degradation to fragile fragments. Using geometric compatibility between the adjacent fragments as the central idea, a reassembly framework for a three-dimensional shell is proposed. 

## Dataset 
A unit sphere was created and shattered into 10 pieces using the 3D computer graphics application Autodesk Maya. They were randomly translated along three axes and rotated at different angles. Each individual piece is stored separately and labeled for further processing.

![Input](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Input%20fragments.PNG)

## 3D - Framework

The steps involved in the framework are described below:
* **Extracting the Contour** The only piece of information we extract from the fragment is its contour. Edges are extracted as polygons and relevant features are computed at each of its vertices. We use Douglas-Peucker Algorithm to remove the collinear points which do not contribute significantly to the matching process. This reduces the processing complexity significantly. The choice of the threshold given as an input to the algorithm should be optimum since smaller values can be less effective and higher values can alter the shape of the fragment itself making it less suitable for the further process.

![Extract_a](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Extract%20contour%20a.PNG) ![Extract_b](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Extract%20contour%20b.PNG) ![Extract_c](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Extract%20contour%20c.PNG)

* **Feature Extraction**  Features extracted for a 3D polygon at its vertices are different from that of a 2D polygon owing to its non-planar nature. Every curve representing a fragment has a set of points P1, P2 … Pn. Each point has the location in the form of 3D coordinates associated with it. We use the numerical approximation for each of the feature defined for a smooth curve. The features extracted here are **Curvature, Derivative of Curvature and Torsion**

* **Pairwise Matching** We use the modified form of Smith Waterman algorithm like in the previous case except for the features matched. Two points A (α1,β1,γ1) and B (α2,β2,γ2) of two different fragments score a similarity score of 1 if the distance between them in the feature space is less than the threshold. For matching fragments i and j, features extracted clockwise for fragment i and counterclockwise for fragment j or vice versa is given as input to the algorithm.
A connectivity score is evaluated for each pair and values below μ=0.1 are discarded. Once a good match (> 0.1) is found, the appropriate 3D transformation of one of the piece is estimated and made to merge with the second fragment and displayed for the user to approve the connection. Once approved, the connectivity score and the start and end vertices of the matching part is stored separately.

![Pairwise_A](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Pairwise%20Matching%20a.PNG) ![Pairwise_b](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Pairwise%20Matching%20a.PNG)
* **Global Reassembly** For each pair of fragments, the connectivity value calculated and approved by the user is recorded in the form of a matrix. When each fragment has found a strong connection with atleast one other fragment implying if no overlaps detected, just one iteration is enough to assemble back all the nine fragments. Starting with the pair having the highest connectivity value, each pair is transformed and merged. At any point throughout the global reassembly process, the user can intervene and undo a merge if any sort of wrong overlaps is visually detected. A major advantage is that the connectivity value need not be calculated over and over again. Since there were no overlaps, in one iteration all of the pieces were assembled back to form the assembled object. 

![assembled](https://github.com/svellaichamy3/Automatic_3D_Jigsaw_Puzzle-Solver_ISARC-Conference-2019/blob/main/images/Assembled.PNG)

## Conclusion
A framework for re-assembling 3D surface object as an extension of the 2D reassembly framework was proposed and verified using simulated datasets. The merits of this framework are manifold. It is an unsupervised reassembly where the reassembled structure is not known prior to the process. The global reassembly does not compute the connectivity values after each pairwise merging reducing computational requirement. Additionally, while the user involvement was minimal, this involvement along with the cluster-based merging process prevented error accumulation. For the given dataset, the reassembly was completed in the first iteration. This way, an efficient tool for the archaeologist to speed up the reassembly is put forward. In future work, the proposed framework will be tested on a real datasets where the fragments are not predefined by the user. This methodology can be used in addition to features extracted from fracture surfaces for validation while reassembling a solid object.
